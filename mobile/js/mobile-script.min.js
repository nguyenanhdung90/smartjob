/**
 * script.js
*/
(function(e){e(document).on("pageinit",function(){e.tabInit();e.modalInit();e(".search .search-btn").on("click",function(){e(".menu-filter").fadeIn(100);e(".job-contents .cat").fadeIn(50);e(".job-contents .job-type").fadeOut(50);e(".resume-contents .resume-cat").fadeIn(50);e(".resume-contents .available").fadeOut(50)});e(".menu-filter .icon-header").on("click",function(){e(".menu-filter").fadeOut(100)});e(".menu-filter .filter-search-btn").on("click",function(){e(".menu-filter").fadeOut(100)});e(".job-tabs .ui-tabs").on("click",function(){var t=e(this).index();e(".tabs .ui-tabs").removeClass("tab-active");e(this).addClass("tab-active");console.log(t);e(".job-contents .tab-cont").fadeOut(50);e(".job-contents .tab-cont").eq(t).fadeIn(100)});e(".resume-tabs .ui-tabs").on("click",function(){var t=e(this).index();e(".tabs .ui-tabs").removeClass("tab-active");e(this).addClass("tab-active");e(".resume-contents .tab-cont").fadeOut(50);e(".resume-contents .tab-cont").eq(t).fadeIn(100)});e(".list-categories .ui-list").on("click",function(){var t=e(this);if(t.hasClass("ui-list-main")){if(t.hasClass("ui-list-active")){t.removeClass("ui-list-active")}else{e(".list-categories .ui-list").removeClass("ui-list-active");t.addClass("ui-list-active")}}else{e(".list-categories .ui-list-main").removeClass("ui-list-active");if(t.hasClass("ui-list-active")){t.removeClass("ui-list-active")}else{e(".list-categories .ui-list").removeClass("ui-list-active");t.addClass("ui-list-active")}}});e(".contact-type .ui-list").on("click",function(){var t=e(this);if(t.hasClass("ui-list-active")){t.removeClass("ui-list-active")}else{e(".contact-type .ui-list").removeClass("ui-list-active");t.addClass("ui-list-active")}});e("#respond").find("a,form").attr("data-ajax","false")});e.tabInit=function(){e(".content-tabs").each(function(){var t=e(this),n=t.find(".tabs"),r=t.find(".tabcontent-wrapper");n.find("li a").click(function(){var t=e(this).parent(),i=n.find("li"),s=e(e(this).attr("href"));console.log(s);i.removeClass("activated");t.addClass("activated");r.find(".tabcontent").hide();s.show()})})};e.modalInit=function(){e(".modal-open").on("click",function(){var t=e(this);var n=t.attr("href");console.log(n);e(n).modal({overlayClose:true});return false})}})(jQuery);

/**
 * mobile-script.js
*/
var query_default={action:"et_fetch_jobs",method:"read",content:{paged:1,author:"",job_type:"",job_category:"",s:"",location:""}};var blog_page=1;var resume_params={paged:1,rq:"",et_location:"",available:""};var enable_ajax=true;var flag_lm=0;(function(e){function t(e){var t=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;return t.test(e)}e(document).on("pageinit",function(){e("#load-more-post").on("click",function(t){t.preventDefault();var n=e(t.currentTarget),r=n.parents(".button-more").find("input#template"),i=e(".list-blog ul"),s=blog_page+1;e.ajax({url:et_globals.ajaxURL,type:"post",data:{page:s,action:"et-mobile-load-more-post",template_value:r.val(),template:r.attr("name")},beforeSend:function(){blog_page++;e.mobile.showPageLoadingMsg()},success:function(t){e.mobile.hidePageLoadingMsg();if(t.success){i.append(t.data);if(blog_page>=t.total){n.parents(".load-blog").hide();console.log(blog_page)}}else{n.parents(".load-blog").hide();blog_page--}}})});var n=window.location;var r=e.mobile.path.parseUrl(n).search;if(r.indexOf("location")>=0){r=decodeURIComponent(r).replace("?location=","");e(".ui-page-active").find("#search_location").val(r);query_default.content.location=r}var i=e.mobile.path.parseUrl(n).pathname;if(i.indexOf("job-type")>=0){var s=i.split("/");i=s[s.length-2];e(".ui-page-active").find(".contact-type a[data="+i+"]").addClass("ui-list-active");query_default.content.job_type=i}var o=null;e(".txt_search").on("keyup",function(){if(o!==null){clearTimeout(o)}o=setTimeout(function(){var t=e(".ui-page-active").find("#txt_search").val();query_default.content.s=t.replace(/[`~!\^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"");query_default.content.paged=1;e.queryItems_default(true)},500)});e(".et_login").on("tap",function(){e.loginUser()});e(".et_logout").on("tap",function(){e.logoutUser()});e(".ui-page-active #et_loadmore").on("tap",function(){console.log("abc");if(enable_ajax){enable_ajax=false;var t=e("ui-page-active li.list-divider").length;var n=parseInt(e(".ui-page-active").find("#cur_page_index").val());var r=e(".ui-page-active").find("#txt_search");var t=r.length>0?r.val():"";var i=t.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"");query_default.content.paged=n+1;if(i!=""){query_default.content.s=i}e.queryItems_default(false);e(".ui-page-active").find("#cur_page_index").val(query_default.content.paged)}});e(".ui-page-active #lm_com_job").on("tap",function(){if(enable_ajax){enable_ajax=false;var t=e(".ui-page-active").find("#max_page_com").val();var n=parseInt(e(".ui-page-active").find("#cur_page").val());if(n<t){query_default.content.author=e(".ui-page-active").find("#company").val();query_default.content.paged=n+1;query_default.content.job_type="";query_default.content.job_category="";query_default.content.s="";query_default.content.location="";e.queryItems_default(false);e(".ui-page-active").find("#cur_page").val(query_default.content.paged)}else return false}});e(".ui-page-active #loadmore_resume").on("tap",function(){if(enable_ajax){resume_params.paged++;console.log(resume_params);e.searchResumes(resume_params,true)}});e(".pick-param").on("tap",function(t){var n=t.currentTarget;var r=e(n).attr("data-name");var i=e(n).attr("data");var s={};s[r]=i;e.changeParam(s)});e("#apply_search_resume").on("tap",function(t){e.changeParam({et_location:e("input#et_location").val()});e.changeParam({paged:1});e.searchResumes(resume_params)});var u=_.debounce(function(){e.changeParam({rq:e("input#resume_search").val()});e.searchResumes(resume_params,false)},700);e("#resume_search").keyup(u);e.searchResumes=function(t,n){if(enable_ajax){enable_ajax=false;t={type:"post",url:et_globals.ajaxURL,data:{action:"et_fetch_resumes",content:resume_params},beforeSend:function(){enable_ajax=false;e.mobile.showPageLoadingMsg()},success:function(t){var r=[];_.each(t.data.resumes,function(e,n){var i=e;var s=_.find(t.data.jobseekers,function(e){return e.ID==i.post_author});i.jobseeker_data=s;r.push(i)});if(resume_params.paged>=t.data.total_pages)e("#loadmore_resume").hide();e.renderResumes(r,n)},complete:function(){enable_ajax=true;e.mobile.hidePageLoadingMsg()}};e.ajax(t)}};e.changeParam=function(e){var e=_.extend(resume_params,e);return e};e.renderResumes=function(t,n){var r=n?true:false;var i=_.template(e("#template_resume").html());if(!r)e(".resume-listview").html("");_.each(t,function(t,n){var r=i(t);e(".resume-listview").append(r)});e(".resume-listview").listview("refresh")};e("#et_remind_email").on("tap",function(){var n=e("#remind_email").val();if(!t(n)){alert("Invalid email format")}else{e.remindEmailUser()}});e("div.content-padding").find("h6").wrap("<h3></h3>");e("#et_search_cat").tap(function(){query_default.content.paged=1;var t=e(".ui-page-active").find("#search_location");if(t.val()!=t.attr("title"))query_default.content.location=t.val();else query_default.content.location="";var n=[];e(".ui-page-active").find("div.list-categories a.ui-list-active").each(function(){n.push(e(this).attr("data"))});query_default.content.job_category=n;var r=[];e(".ui-page-active").find("div.contact-type a.ui-list-active").each(function(){r.push(e(this).attr("data"))});query_default.content.job_type=r;e.queryItems_default(true)});e(".ui-page-active #com_location").on("tap",function(){})});e.fn.delayKeyup=function(t,n){var r=0;e(this).keyup(function(){clearTimeout(r);r=setTimeout(t,n)});return e(this)};e.loginUser=function(){var t={action:"et_login",user_name:e("#login_username").val(),user_pass:e("#login_pass").val(),user_email:e("#login_username").val()};e.ajax({url:et_globals.ajaxURL,type:"post",data:t,beforeSend:function(){e.mobile.showPageLoadingMsg()},error:function(t){e.mobile.hidePageLoadingMsg()},success:function(t){e.mobile.hidePageLoadingMsg();if(t.status){window.location=et_globals.homeURL}else{alert(t.msg)}}})};e.logoutUser=function(){e.ajax({url:et_globals.ajaxURL,type:"post",data:{action:"et_logout"},beforeSend:function(){e.mobile.showPageLoadingMsg()},error:function(t){e.mobile.hidePageLoadingMsg()},success:function(t){e.mobile.hidePageLoadingMsg();if(t.status===200){window.location=et_globals.homeURL}else{alert(t.msg)}}})};e.registerUser=function(){var t={action:"et_register",username:e("#reg_username").val(),email:e("#reg_email").val(),password:e("#reg_pass").val(),retype_pass:e("#reg_retype_pass").val()};e.ajax({url:et_globals.ajaxURL,type:"post",data:t,beforeSend:function(){e.mobile.showPageLoadingMsg()},error:function(t){e.mobile.hidePageLoadingMsg()},success:function(t){e.mobile.hidePageLoadingMsg();if(t.success){e.mobile.changePage(t.redirect_url)}else{alert(t.message)}}})};e.remindEmailUser=function(){var t={action:"et_remind_job",share_email:e("#remind_email").val(),job_id:e("#current_job_id").val()};e.ajax({url:et_globals.ajaxURL,type:"post",data:t,beforeSend:function(){e.mobile.showPageLoadingMsg()},error:function(t){e.mobile.hidePageLoadingMsg()},success:function(t){e.mobile.hidePageLoadingMsg();if(t.success){e.modal.close.call(e("#modal_apply"));alert(e(t.msg).html())}else{alert(t.msg)}}})};e.queryItems_default=function(t){e.ajax({url:et_globals.ajaxURL,type:"post",data:query_default,beforeSend:function(){e.mobile.showPageLoadingMsg()},error:function(t){e.mobile.hidePageLoadingMsg()},success:function(n){e.mobile.hidePageLoadingMsg();current_page=n.data.paged;max_page_query=n.data.total_pages;if(n.status){var r=0;if(e(".ui-page-active").find(".list-divider").length==1){r=1}if(e(".ui-page-active").find(".list-divider").length==2){r=2}if(!t){flag_lm=0;e.render_LoadMoreJob(n.data.jobs,r);if(current_page>=max_page_query){e(".ui-page-active").find("#lm_com_job").hide();e(".ui-page-active").find("#et_loadmore").hide()}else{e(".ui-page-active").find("#lm_com_job").show();e(".ui-page-active").find("#et_loadmore").show()}}else{e(".ui-page-active").find("#cur_page_index").val(query_default.content.paged);e(".ui-page-active").find("#et_loadmore").hide();var i=e(".ui-page-active").find(".listview");i.html("");console.log(n.data.jobs);e.render_LoadSearchJob(n.data.jobs);if(current_page<max_page_query&&max_page_query!=0){e(".ui-page-active").find("#et_loadmore").show()}}}else alert("Query error")}})};e.render_LoadMoreJob=function(t,n){var r=e("div.ui-page-active ul.listview");for(value in t){var i=t[value];if(i.featured==0&&flag_lm==0&&n==1){var s=e(".list-divider:first-child").text();console.log(s);if(s!="Jobs"&&s!="JobsJobs"){r.append(e('<li class="list-divider">').text("Jobs"));flag_lm=1}}var o=_.template(e("#template_job").html());if(e("#template_mobile_"+i.template_id).length>0){o=_.template(e("#template_mobile_"+i.template_id).html())}else{o=_.template(e("#template_job").html())}r.append(o(i))}e("div.ui-page-active ul.listview").listview("refresh");enable_ajax=true};e.render_LoadSearchJob=function(t){var n=0,r=0,i=e("ul.listview"),s,o;if(t!=""){for(o=0;o<t.length;o++){s=t[o];if(s.featured==1&&r==0){i.append(e('<li class="list-divider">').text("Featured Jobs"));r=1}if(s.featured==n){i.append(e('<li class="list-divider">').text("Jobs"));n=1}var u=_.template(e("#template_job").html());if(e("#template_mobile_"+s.template_id).length>0){u=_.template(e("#template_mobile_"+s.template_id).html())}else{u=_.template(e("#template_job").html())}i.append(u(s))}}else{if(query_default.content.s==""){i.append(e('<li class="no-result">').text("There is no result for your search."))}else{i.append(e('<li class="no-result">').text("There is no result for keyword ").append(e("<strong>").text('"'+query_default.content.s+'"')))}}e("div.ui-page-active ul.listview").listview("refresh")}})(jQuery);

/**
 * mobile-resume
*/
(function(e){e(document).on("pageinit",function(){e("#jobseeker_message").on("submit",function(t){t.preventDefault();var n={data:{action:"et_contact_jobseeker",content:e(this).serialize()},success:function(t){if(t.success){e("#msg_pop").html("<p>"+t.msg+"</p>").popup("open");setTimeout(function(){e.mobile.changePage(e("#cancel_url").val())},3e3)}else{e("#msg_pop").html("<p>"+t.msg+"</p>").popup("open");setTimeout(function(){e("#msg_pop").popup("close")},3e3)}}};n=e.ajaxParams(n);e.ajax(n)});e.ajaxParams=function(t){var n=t.beforeSend||function(){};var r=t.complete||function(){};var i={type:"post",url:et_globals.ajaxURL,beforeSend:function(){e.mobile.showPageLoadingMsg();n()},complete:function(){e.mobile.hidePageLoadingMsg();r()}};return e.extend(t,i)}})})(jQuery);