jQuery(document).ready(function(e){JobEngine.Views.CompanyProfile=Backbone.View.extend({el:e("#page_company_profile"),events:{"click #submit_profile":"updateProfile"},initialize:function(){var e=this,t=this.$("#user_logo_container");this.$form=this.$("form#profile");this.model=new JobEngine.Models.Company(JSON.parse(this.$("#profile_data").html()));var n=new JobEngine.Views.BlockUi;this.logo_uploader=new JobEngine.Views.File_Uploader({el:t,uploaderID:"user_logo",thumbsize:"thumbnail",multipart_params:{_ajax_nonce:t.find(".et_ajaxnonce").attr("id"),action:"et_logo_upload",author:this.model.get("id")},cbUploaded:function(t,n,r){if(r.success){e.model.set("user_logo",r.data,{silent:true})}pubsub.trigger("je:notification",{msg:r.msg,notice_type:r.success?"success":"error"})},beforeSend:function(e){n.block(t.find(".company-thumbs"))},success:function(){n.unblock()}});this.validator=this.$form.validate({ignore:"select, .plupload input",rules:{display_name:"required",user_email:{required:true,email:true},user_url:{required:true,url:true}}})},updateProfile:function(e){e.preventDefault();var t={},n=["display_name","user_email","user_url"],r=this.$form,i;if(this.validator.form()){for(i=0;i<n.length;i++){var s=r.find("input#"+n[i]);t[n[i]]=s.val()}this.model.save(t,{success:function(e,t){pubsub.trigger("je:notification",{msg:t.msg,notice_type:t.success?"success":"error"})}})}}});new JobEngine.Views.CompanyProfile})