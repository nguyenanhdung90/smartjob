jQuery(document).ready(function(e){JobEngine.Views.DashboardItem=Backbone.View.extend({tagName:"li",className:"acc-job-item",events:{"click .action-edit":"edit","click .action-archive":"archiveJob"},initialize:function(){if(this.model instanceof JobEngine.Models.Job){this.model.on("change",this.render,this)}this.blockUi=new JobEngine.Views.BlockUi},template:_.template(e("#job_item_template").html()),render:function(){var e=this.model.get("status");this.model.set("dashboardStatus",et_dashboard.statuses[e]);this.$el.addClass("job-item-"+e).html(this.template(this.model.toJSON()));return this},edit:function(e){e.preventDefault();if(!this.model.has("id")){this.model.set("id",this.model.get("ID"),{silent:true})}pubsub.trigger("je:job:onEdit",this.model)},archiveJob:function(e){var t=this;e.preventDefault();this.model.archive({beforeSend:function(){t.blockUi.block(t.$el)},success:function(e,n){t.$el.fadeOut("normal",function(){t.$el.remove();pubsub.trigger("je:job:afterHideArchivedJob",e)})},silent:true})}});JobEngine.Views.Dashboard=Backbone.View.extend({el:e(".account-jobs"),initialize:function(){var e=this,t=this.$("#job_list_data"),n=this.$(".job-account-list"),r,i;t=t.length>0?JSON.parse(t.html()):null;if(t!==null){for(r=0;r<t.length;r++){i=new JobEngine.Models.Job(t[r]);i.author=JobEngine.app.currentUser;new JobEngine.Views.DashboardItem({el:n.find("li:eq("+r+")"),model:i})}}if(typeof this.editModalView==="undefined"||!(this.editModalView instanceof JobEngine.Views.Modal_Edit_Job)){this.editModalView=new JobEngine.Views.Modal_Edit_Job}pubsub.on("je:job:onEdit",this.onEditJob,this);pubsub.on("je:job:afterHideArchivedJob",this.afterHideArchivedJob,this)},afterHideArchivedJob:function(e){var t=new JobEngine.Views.DashboardItem({model:e}),n=t.render().$el.hide(),r=this.$("li.job-item-archive:first");if(r.length>0){n.insertBefore(r).fadeIn("slow")}else{n.prependTo(this.$("ul.job-account-list")).fadeIn("slow")}},onEditJob:function(e){if(typeof this.editModalView==="undefined"||!(this.editModalView instanceof JobEngine.Views.Modal_Edit_Job)){this.editModalView=new JobEngine.Views.Modal_Edit_Job}this.editModalView.onEdit(e)}});new JobEngine.Views.Dashboard})